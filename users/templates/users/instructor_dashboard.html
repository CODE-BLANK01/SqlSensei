<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instructor Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            display: flex;
        }
        .sidebar {
            width: 250px;
            height: 100vh;
            background: #343a40;
            padding: 20px;
            position: fixed;
            color: white;
        }
        .sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
        }
        .sidebar a:hover, .sidebar .active {
            background: #495057;
        }
        .content {
            margin-left: 260px;
            padding: 20px;
            width: 100%;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <h4 class="text-center">Instructor Dashboard</h4>
        <hr>

        <!-- Course Management -->
        <a class="active" data-bs-toggle="collapse" href="#courseMenu" role="button">üìö Course Management</a>
        <div class="collapse show" id="courseMenu">
            <a href="#" class="ps-3" onclick="showForm()">‚ûï Create Course</a>
            <a id = "manageCoursesBtn" href="#" class="ps-3" onclick="showManageCourses()">üìå Manage Courses</a>
        </div>

        <!-- Assignments Management -->
        <a data-bs-toggle="collapse" href="#assignmentMenu" role="button">üìÇ Assignments</a>
        <div class="collapse" id="assignmentMenu">
            <a href="#" class="ps-3" onclick="showAssignmentForm()">‚ûï Create Assignment</a>
            <a href="#" class="ps-3" onclick="showManageAssignments()">üìå Manage Assignments</a>
        </div>

         <!-- Question Bank -->
         <a data-bs-toggle="collapse" href="#questionMenu" role="button">üìù Question Bank</a>
         <div class="collapse" id="questionMenu">
             <a href="#" class="ps-3" onclick="showQuestionForm()">‚ûï Create Question</a>
             <a href="#" class="ps-3" onclick="showManageQuestions()">üìñ View Questions</a>
         </div>

        <!-- Student Approvals -->
        <a>‚úÖ Student Approvals</a>

        <!-- Logout -->
        <hr>
        <a href="{% url 'logout' %}" class="text-danger">üö™ Logout</a>
    </div>

    <!-- Main Content -->
    <div class="content">
        <h2>Welcome, {{user_name}}</h2>
        <p>Select an option from the sidebar to manage courses, questions, and student approvals.</p>

        <!-- Course Creation Form (Hidden Initially) -->
        <div id="courseFormContainer" class="hidden">
            <h3>Create a Course</h3>
            <form method="post" action="{% url 'create_course' %}">
                {% csrf_token %}
                <div class="mb-3">
                    <label class="form-label">Course Title</label>
                    <input type="text" name="course_title" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Course Description</label>
                    <textarea name="course_description" class="form-control"></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Course Token</label>
                    <input type="text" name="course_token" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Start Date</label>
                    <input type="date" name="course_start_date" class="form-control">
                </div>
                <div class="mb-3">
                    <label class="form-label">End Date</label>
                    <input type="date" name="course_end_date" class="form-control">
                </div>
                <div class="mb-3">
                    <label class="form-label">Enrollment Status</label>
                    <select name="enrollment_status" class="form-control">
                        <option value="1">Open</option>
                        <option value="0">Closed</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Create Course</button>
            </form>
        </div>
        
    

        <!-- Manage Courses Section (Hidden Initially) -->
        <div id="manageCoursesContainer" class="hidden {% if show_manage_courses %}show{% endif %}">
            <h3>Manage Courses</h3>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Course Title</th>
                        <th>Description</th>
                        <th>Start Date</th>
                        <th>End Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for course in courses %}
                    <tr>
                        <td>{{ course.course_title }}</td>
                        <td>{{ course.course_description }}</td>
                        <td>{{ course.course_start_date }}</td>
                        <td>{{ course.course_end_date }}</td>
                        <td>
                            <a href="#">Edit</a> | 
                            <a href="#" onclick="confirmDelete({{ course.course_id }})" class="text-danger">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div id="assignmentFormContainer" class="hidden">
            <h3>Create an Assignment</h3>
            <form method="post" action="{% url 'create_assignment' %}">
                {% csrf_token %}
                <div class="mb-3">
                    <label class="form-label">Course</label>
                    <select name="course_id" class="form-control" required>
                        {% for course in courses %}
                            <option value="{{ course.course_id }}">{{ course.course_title }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Assignment Title</label>
                    <input type="text" name="assignment_title" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Description</label>
                    <textarea name="description" class="form-control"></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Deadline</label>
                    <input type="datetime-local" name="deadline" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Create Assignment</button>
            </form>
        </div>
        
        <!-- Manage Assignments Section (Hidden Initially) -->
        <div id="manageAssignmentsContainer" class="hidden {% if show_manage_assignments %}show{% endif %}">
            <h3>Manage Assignments</h3>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Assignment Title</th>
                        <th>Course</th>
                        <th>Deadline</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for assignment in assignments %}
                    <tr>
                        <td>{{ assignment.assignment_title }}</td>
                        <td>{{ assignment.course.course_title }}</td>
                        <td>{{ assignment.deadline }}</td>
                        <td>
                            <a href="#">Edit</a> | 
                            <a href="#" onclick="confirmDeleteAssignment({{ assignment.assignment_id }})" class="text-danger">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Question Creation Form (Hidden Initially) -->
        <div id="questionFormContainer" class="hidden">
            <h3>Create a Question</h3>
            <form method="post" action="{% url 'create_question' %}">
                {% csrf_token %}
                <div class="mb-3">
                    <label class="form-label">Question Title</label>
                    <input type="text" name="question_title" class="form-control" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Topic</label>
                    <input type="text" name="topic" class="form-control">
                </div>
                <div class="mb-3">
                    <label class="form-label">Difficulty Level</label>
                    <select name="difficulty_level" class="form-control">
                        <option value="Easy">Easy</option>
                        <option value="Medium">Medium</option>
                        <option value="Hard">Hard</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Description</label>
                    <textarea name="description" class="form-control"></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Access Type</label>
                    <select name="access_type" class="form-control">
                        <option value="Public">Public</option>
                        <option value="Private">Private</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Create Question</button>
            </form>
        </div>

        <!-- Manage Questions Section (Hidden Initially) -->
        <div id="manageQuestionsContainer" class="hidden {% if show_manage_questions %}show{% endif %}">
            <h3>Manage Questions</h3>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Question Title</th>
                        <th>Topic</th>
                        <th>Difficulty</th>
                        <th>Access Type</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for question in questions %}
                    <tr>
                        <td>{{ question.question_title }}</td>
                        <td>{{ question.topic }}</td>
                        <td>{{ question.difficulty_level }}</td>
                        <td>{{ question.access_type }}</td>
                        <td>
                            <a href="#">Edit</a> | 
                            <a href="#" onclick="confirmDeleteQuestion({{ question.question_id }})" class="text-danger">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Assignment Creation Form (Hidden Initially) -->


    <script>
        // Show Course Creation Form
        function showForm() {
            document.getElementById("courseFormContainer").classList.remove("hidden");
            document.getElementById("manageCoursesContainer").classList.add("hidden");
            document.getElementById("assignmentFormContainer").classList.add("hidden");
            document.getElementById("manageAssignmentsContainer").classList.add("hidden");
            document.getElementById("questionFormContainer").classList.add("hidden");
            document.getElementById("manageQuestionsContainer").classList.add("hidden");
        }

        // Show Manage Courses Section
        function showManageCourses() {
            document.getElementById("manageCoursesContainer").classList.remove("hidden");
            document.getElementById("courseFormContainer").classList.add("hidden");
            document.getElementById("assignmentFormContainer").classList.add("hidden");
            document.getElementById("manageAssignmentsContainer").classList.add("hidden");
            document.getElementById("questionFormContainer").classList.add("hidden");
            document.getElementById("manageQuestionsContainer").classList.add("hidden");
        }

        function confirmDelete(courseId) {
            if (confirm("Are you sure you want to delete this course? This action cannot be undone.")) {
                window.location.href = `/users/instructor/delete-course/${courseId}/`;
            }
        }
        window.onload = function() {
            if (getQueryParam("show_manage_courses") === "true") {
                showManageCourses();
            }
            else if (getQueryParam("show_manage_assignments") === "true") {
                showManageAssignments();
            }
            else if (getQueryParam("show_manage_questions") === "true") {
                showManageQuestions();
            }
        };
        function getQueryParam(param) {
            let urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }
        function showAssignmentForm() {
            document.getElementById("assignmentFormContainer").classList.remove("hidden");
            document.getElementById("manageAssignmentsContainer").classList.add("hidden");
            document.getElementById("manageCoursesContainer").classList.add("hidden");
            document.getElementById("courseFormContainer").classList.add("hidden");
            document.getElementById("questionFormContainer").classList.add("hidden");
            document.getElementById("manageQuestionsContainer").classList.add("hidden");
        }

        function showManageAssignments() {
            document.getElementById("manageAssignmentsContainer").classList.remove("hidden");
            document.getElementById("assignmentFormContainer").classList.add("hidden");
            document.getElementById("manageCoursesContainer").classList.add("hidden");
            document.getElementById("courseFormContainer").classList.add("hidden");
            document.getElementById("questionFormContainer").classList.add("hidden");
            document.getElementById("manageQuestionsContainer").classList.add("hidden");
        }

        function confirmDeleteAssignment(assignmentId) {
            if (confirm("Are you sure you want to delete this assignment?")) {
                window.location.href = `/users/instructor/delete-assignment/${assignmentId}/`;
            }
        }

        // Show Question Creation Form
        function showQuestionForm() {
            document.getElementById("questionFormContainer").classList.remove("hidden");
            document.getElementById("manageQuestionsContainer").classList.add("hidden");
            document.getElementById("courseFormContainer").classList.add("hidden");
            document.getElementById("manageCoursesContainer").classList.add("hidden");
            document.getElementById("assignmentFormContainer").classList.add("hidden");
            document.getElementById("manageAssignmentsContainer").classList.add("hidden");
        }

        // Show Manage Questions Section
        function showManageQuestions() {
            document.getElementById("manageQuestionsContainer").classList.remove("hidden");
            document.getElementById("questionFormContainer").classList.add("hidden");
            document.getElementById("courseFormContainer").classList.add("hidden");
            document.getElementById("manageCoursesContainer").classList.add("hidden");
            document.getElementById("assignmentFormContainer").classList.add("hidden");
            document.getElementById("manageAssignmentsContainer").classList.add("hidden");
        }

        function confirmDeleteQuestion(questionId) {
            if (confirm("Are you sure you want to delete this question?")) {
                window.location.href = `/users/instructor/delete-question/${questionId}/`;
            }
        }
    </script>

</body>
</html>
